
# Book

## 操作系统概念

### 导论

#### 批处理系统

#### 多道程序系统

#### 分时系统

#### 桌面系统

#### 多处理器系统

#### 分布式系统

#### 集群系统

#### 实时系统

### 计算机系统结构

#### 计算机系统操作

#### I/O结构
#### 存储结构
#### 存储层次
#### 硬件保护
##### I/O保护
##### CPU保护
##### 内存保护
#### 网络结构

### 操作系统结构
#### 系统组成
#### 操作系统服务
#### 系统调用
#### 系统程序
#### 系统结构
#### 虚拟机
#### 系统设计与实现
#### 系统生成

### 进程
#### 进程概念
#### 进程调度
#### 进程操作
#### 进程协作
#### 进程间通信
#### 客户机-服务器通信

### 线程
#### 概述
##### 用户线程和内核线程
#### 多线程模型
#### 若干多线程问题
#### Pthread线程
#### Solaris 2线程
#### Windows 2000 线程
#### Linux线程
#### Java线程

### CPU调度
#### 基本概念
##### CPU-I/O区间周期
##### CPU调度决策四种环境
* 当一个进程从运行状态切换到等待状态
* 当一个进程从运行状态切换到就绪状态
* 当一个进程从等待状态切换到就绪状态
* 当一个进程终止时
##### 可抢占式调度
#### 调度准则
#### 调度算法
##### 先到先服务调度
##### 最短作业优先调度
##### 优先权调度
##### 轮转法调度
##### 多级队列调度
##### 多级反馈队列调度
#### 多处理器调度
#### 实时调度
#### 算法评估
#### 调度模型
##### Solaris 2 
##### Windows 2000
##### Linux

### 进程同步
#### 背景
#### 临界区域问题
#### 同步硬件
#### 信号量
#### 经典同步问题
1. 有限缓冲问题
2. 读者-作者问题
3. 哲学家进餐问题
#### 临界区域
#### 管程
#### 操作系统同步
#### 原子事务
##### 存储媒介类型
- 易失性存储
- 非易失性存储
- 稳定存储
##### 基于日志的恢复
- 日志结构
    - 事务名称
    - 数据项名称
    - 旧值
    - 新值
- 恢复算法步骤
    - undo，幂等
    - redo，幂等
##### 检查点
- 查找最近检查点执行的事务Ti
- Ti之后的事务Tk如果记录了<Tk commits>, 则redo(Tk)
- Ti之后的事务Tk如果没有记录<Tk commits>, 则undo(Tk)
##### 串行化
- 加锁协议（无法避免死锁）
    - 增长阶段：事务可以获取锁，但不能释放任何锁
    - 收缩阶段：事务可以释放锁，但不能获取任何新锁
- 基于时间戳的协议（可以避免死锁）
    - 数据项Q W-timestamp(Q)
    - 数据项Q R-timestamp(Q)
    
### 死锁
#### 系统模型
#### 死锁特点
#### 死锁处理方法
#### 死锁预防
##### 占有并等待 
- 执行前申请并占有所有资源
- 没有资源占有时才可以申请资源
##### 可抢占
适用于CPU或内存，这种状态可以保存和恢复的资源
##### 避免循环等待
对资源排序，占有资源时只能申请排序后面的资源， 
如果申请排序前面的资源，必需先释放所有排序后面的资源
#### 死锁避免
##### 资源分配图算法
##### 银行家算法
#### 死锁检测
##### 等待图算法
##### 一个类似银行家算法的算法
#### 死锁恢复
##### 进程终止
##### 资源抢占

### 内存管理
#### 背景
##### 地址捆绑

将指令与数据绑定到内存地址

- 编译时
- 加载时
- 执行时

##### 逻辑地址与物理地址
CPU所生成的地址通常称为逻辑地址，而内存单元看到的地址(即，加载到内存地址寄存器中的地址)
通常称为物理地址
- 编译时绑定与加载时绑定，逻辑地址与物理地址相同
- 运行时绑定，逻辑地址与物理地址不同
##### 动态加载
##### 动态链接与共享库
##### 覆盖
#### 交换
#### 连续内存分配
##### 内存保护
##### 内存分配
- 首次适应
- 最佳适应
- 最差适应 
##### 碎片
- 内部碎片
- 外部碎片
#### 分页
##### 基本方法
##### 硬件支持
- 页表基寄存器

访问一个字节需要访问内存两次

- 翻译后备缓冲器
#### 保护
有效位-无效位
#### 页表结构
- 层次化分页
- 哈希页表
- 反向页表
- 共享页
#### 分段

一个Pascal编译器可能会创建如下不同的段
- 全局变量
- 过程调用堆栈, 以用于保存参数和返回地址
- 每个过程或函数的代码部分
- 每个过程或函数的局部变量部分
##### 基本方法
##### 硬件
- 段表
##### 保护与共享
##### 碎片
#### 带有分页的分段

### 虚拟内存

#### 背景

#### 请求页面调度

##### 请求页面调度性能

#### 进程创建

##### 写时拷贝

##### 内存映射文件

#### 页面置换

##### 基本方法

- 桢分配算法
- 页面置换算法

##### FIFO页置换

belady

##### 最优页置换

- 计数器
- 堆栈

##### LRU页置换

##### LRU近似页置换

- 附加引用位算法
- 二次机会算法
- 增强型二次机会算法

##### 给予计数的页置换

- 最不经常使用页置换算法
- 最经常使用页置换算法

##### 页缓冲算法

#### 帧分配

在指令完成前出现页错误， 该指令必须重新执行

##### 帧的最小数量

##### 分配算法

##### 全局分配和局部分配

#### 系统颠簸

##### 工作集合模型

##### 页错误频率

### 文件系统接口

#### 文件概念

##### 文件属性

- 名称
- 标识符
- 类型
- 位置
- 大小
- 保护
- 时间、日期和用户标识

##### 文件操作

- 创建文件
- 写文件
- 读文件
- 在文件内重定位
- 删除文件
- 截短文件

操作系统打开文件表： 记录所有进程打开文件信息
进程打开文件表： 每个打开条目指向操作系统打开文件表的条目信息

打开文件表内容：
- 文件指针
- 文件打开计数
- 文件磁盘位置
- 访问权限

##### 文件类型
##### 文件结构
##### 内部文件结构

磁盘的块大小和扇区大小
若干逻辑记录打包

unix操作系统定义所有文件为字节流

内部碎片

#### 访问方法

##### 顺序访问

编辑器和编译器通常按这种方式访问文件

##### 直接访问

允许程序按任意顺序进行快速读写， 这是因为磁盘允许对任意文件块进行读或写

数据库通常使用这种类型文件

##### 其他访问方法：创建索引

#### 目录结构

目录操作

- 搜索文件
- 创建文件
- 删除文件
- 列出目录
- 重命名文件
- 跟踪文件系统

##### 单层目录

##### 双层目录

##### 树型目录

##### 无环图目录

##### 通用图目录

#### 文件系统安装

#### 文件共享

##### 多用户

##### 远程文件系统

- 客户机-服务器模型
- 分布式信息系统

##### 一致性语义
##### UNIX语义
##### 会话语义
##### 永久共享文件语义

#### 保护

- 读
- 写
- 执行
- 添加
- 删除
- 列表清单

##### 访问控制
- 访问控制列表 ACL
- 拥有者、组、其他

-----------------------------------
### 其他
#### 阻塞
    一个函数在返回之前等待程序处理完成。阻塞原因很多，比如网络IO、磁盘IO、独占锁等。
事实上，每个函数都有一点阻塞
    
#### 非阻塞

#### 同步

#### 异步
    异步是一个函数直接返回，并没有等待函数执行完成
##### 异步接口的几种类型
* Callback argument
* Return a placeholder (Future, Promise, Deferred)
* deliver to a queue
* Callback registry (e.g. POSIX signals)

